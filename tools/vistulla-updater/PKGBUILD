# Maintainer: Patryk <patryk@local>

pkgname=vistulla-updater
pkgver=0.1.0
pkgrel=1
pkgdesc="GUI aktualizator systemu (pacman) i frontend Flatpak dla VistulaOS (Cinnamon)"
arch=('any')
url="https://example.invalid/vistulla-updater"
license=('custom')
depends=(
  'python'
  'gtk3'
  'python-gobject'
  'gobject-introspection'
  'flatpak'
  'pacman-contrib'
  'polkit'
)
makedepends=(
  'python-build'
  'python-installer'
  'python-setuptools'
  'python-wheel'
)

# Budowanie z tarballa źródeł (zalecane do repo pacmana).
# Utwórz go np. tak:
#   git archive --format=tar --prefix=${pkgname}-${pkgver}/ v${pkgver} | gzip -9 > ${pkgname}-${pkgver}.tar.gz
source=("${pkgname}-${pkgver}.tar.gz")
sha256sums=('SKIP')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  python -m build --wheel --no-isolation
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  python -m installer --destdir="${pkgdir}" dist/*.whl

  install -Dm644 packaging/vistulla-updater.desktop "${pkgdir}/usr/share/applications/vistulla-updater.desktop"
  install -Dm644 README.md "${pkgdir}/usr/share/doc/${pkgname}/README.md"
}
